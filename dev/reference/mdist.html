<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>(Deprecated, in favor of match_on) Create matching distances — mdist • optmatch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="(Deprecated, in favor of match_on) Create matching distances — mdist"><meta name="description" content="Deprecated in favor of match_on"><meta property="og:description" content="Deprecated in favor of match_on"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">optmatch</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.10.7.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/fullmatch-vignette.html">Matching in R using the optmatch package</a></li>
    <li><a class="dropdown-item" href="../articles/matching-from-foreign-software.html">Using Optmatch on data in SAS, Stata, etc</a></li>
    <li><a class="dropdown-item" href="../articles/matching-within-subgroups.html">Combining Matches Within Subgroups</a></li>
    <li><a class="dropdown-item" href="../articles/MCFSolutions.html">Classes and methods for min-cost flow solutions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/markmfredrickson/optmatch/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>(Deprecated, in favor of <code><a href="match_on-methods.html">match_on</a></code>) Create matching distances</h1>
      <small class="dont-index">Source: <a href="https://github.com/markmfredrickson/optmatch/blob/master/R/mdist.R" class="external-link"><code>R/mdist.R</code></a></small>
      <div class="d-none name"><code>mdist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Deprecated in favor of <code><a href="match_on-methods.html">match_on</a></code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mdist</span><span class="op">(</span><span class="va">x</span>, structure.fmla <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'optmatch.dlist'</span></span>
<span><span class="fu">mdist</span><span class="op">(</span><span class="va">x</span>, structure.fmla <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class '`function`'</span></span>
<span><span class="fu">mdist</span><span class="op">(</span><span class="va">x</span>, structure.fmla <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">mdist</span><span class="op">(</span><span class="va">x</span>, structure.fmla <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span>, subset <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'glm'</span></span>
<span><span class="fu">mdist</span><span class="op">(</span><span class="va">x</span>, structure.fmla <span class="op">=</span> <span class="cn">NULL</span>, standardization.scale <span class="op">=</span> <span class="va">mad</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'bigglm'</span></span>
<span><span class="fu">mdist</span><span class="op">(</span><span class="va">x</span>, structure.fmla <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span>, standardization.scale <span class="op">=</span> <span class="va">mad</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'numeric'</span></span>
<span><span class="fu">mdist</span><span class="op">(</span><span class="va">x</span>, structure.fmla <span class="op">=</span> <span class="cn">NULL</span>, trtgrp <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The object to use as the basis for forming the mdist.
Methods exist for formulas, functions, and generalized linear
models.</p></dd>


<dt id="arg-structure-fmla">structure.fmla<a class="anchor" aria-label="anchor" href="#arg-structure-fmla"></a></dt>
<dd><p>A formula denoting the treatment variable on
the left hand side and an optional grouping expression on the
right hand side. For example, <code>z ~ 1</code> indicates no
grouping. <code>z ~ s</code> subsets the data only computing distances
within the subsets formed by <code>s</code>. See method notes, below,
for additional formula options.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional method arguments. Most methods require a
'data' argument.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data where the variables references in <code>x</code> live.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>If non-<code>NULL</code>, the subset of <code>data</code> to be used.</p></dd>


<dt id="arg-standardization-scale">standardization.scale<a class="anchor" aria-label="anchor" href="#arg-standardization-scale"></a></dt>
<dd><p>A function to scale the distances; by
default uses <code>mad</code>.</p></dd>


<dt id="arg-trtgrp">trtgrp<a class="anchor" aria-label="anchor" href="#arg-trtgrp"></a></dt>
<dd><p>Dummy variable for treatment group membership.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Object of class <code>optmatch.dlist</code>, which is suitable
  to be given as <code>distance</code> argument to
  <code><a href="fullmatch.html">fullmatch</a></code> or <code><a href="pairmatch.html">pairmatch</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>mdist</code> method provides three ways to construct a
matching distance (i.e., a distance matrix or suitably organized
list of such matrices): guided by a function, by a fitted model,
or by a formula.  The class of the first argument given to
<code>mdist</code> determines which of these methods is invoked.</p>
<p>The <code>mdist.function</code> method takes a function of two
arguments. When called, this function will receive the treatment
observations as the first argument and the control observations as
the second argument. As an example, the following computes the raw
differences between values of <code>t1</code> for treatment units (here,
nuclear plants with <code>pr==1</code>) and controls (here, plants with
<code>pr==0</code>), returning the result as a distance matrix:</p>
<p><code>sdiffs &lt;- function(treatments, controls) {
     abs(outer(treatments$t1, controls$t1, `-`))
   }
 </code></p>
<p>The <code>mdist.function</code> method does similar things as the
 earlier optmatch function <code>makedist</code>, although the interface
 is a bit different.</p>
<p>The <code>mdist.formula</code> method computes the squared Mahalanobis
 distance between observations, with the right-hand side of the
 formula determining which variables contribute to the Mahalanobis
 distance. If matching is to be done within strata, the
 stratification can be communicated using either the
 <code>structure.fmla</code> argument (e.g. <code>~ grp</code>) or as part of
 the main formula (e.g. <code>z ~ x1 + x2 | grp</code>).</p>
<p>An <code>mdist.glm</code> method takes an argument of class <code>glm</code>
 as first argument.  It assumes that this object is a fitted
 propensity model, extracting distances on the linear propensity
 score (logits of the estimated conditional probabilities) and, by
 default, rescaling the distances by the reciprocal of the pooled
 s.d. of treatment- and control-group propensity scores.  (The
 scaling uses <code>mad</code>, for resistance to outliers, by default;
 this can be changed to the actual s.d., or rescaling can be
 skipped entirely, by setting argument
 <code>standardization.scale</code> to <code>sd</code> or <code>NULL</code>,
 respectively.)  A <code>mdist.bigglm</code> method works analogously
 with <code>bigglm</code> objects, created by the <code>bigglm</code> function
 from package ‘biglm’, which can handle bigger data sets
 than the ordinary glm function can.  In contrast with
 <code>mdist.glm</code> it requires additional <code>data</code> and
 <code>structure.fmla</code> arguments.  (If you have enough data to
 have to use <code>bigglm</code>, then you'll probably have to subgroup
 before matching to avoid memory problems. So you'll have to use
 the <code>structure.fmla</code> argument anyway.)</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>P.~R. Rosenbaum and D.~B. Rubin (1985),
  ‘Constructing a control group using multivariate matched
  sampling methods that incorporate the propensity score’,
  <em>The American Statistician</em>, <b>39</b> 33–38.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fullmatch.html">fullmatch</a></code>, <code><a href="pairmatch.html">pairmatch</a></code>,
  <code><a href="match_on-methods.html">match_on</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mark M. Fredrickson</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Hansen, Mark Fredrickson, Josh Errickson, Josh Buckner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>


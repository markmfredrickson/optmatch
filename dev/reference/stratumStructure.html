<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Return structure of matched sets — stratumStructure • optmatch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Return structure of matched sets — stratumStructure"><meta name="description" content="Tabulate treatment:control ratios occurring in matched sets, and
the frequency of their occurrence."><meta property="og:description" content="Tabulate treatment:control ratios occurring in matched sets, and
the frequency of their occurrence."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">optmatch</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.10.8.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/fullmatch-vignette.html">Matching in R using the optmatch package</a></li>
    <li><a class="dropdown-item" href="../articles/matching-from-foreign-software.html">Using Optmatch on data in SAS, Stata, etc</a></li>
    <li><a class="dropdown-item" href="../articles/matching-within-subgroups.html">Combining Matches Within Subgroups</a></li>
    <li><a class="dropdown-item" href="../articles/MCFSolutions.html">Classes and methods for min-cost flow solutions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/markmfredrickson/optmatch/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Return structure of matched sets</h1>
      <small class="dont-index">Source: <a href="https://github.com/markmfredrickson/optmatch/blob/master/R/stratumStructure.R" class="external-link"><code>R/stratumStructure.R</code></a></small>
      <div class="d-none name"><code>stratumStructure.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Tabulate treatment:control ratios occurring in matched sets, and
the frequency of their occurrence.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stratumStructure</span><span class="op">(</span><span class="va">stratum</span>, trtgrp <span class="op">=</span> <span class="cn">NULL</span>, min.controls <span class="op">=</span> <span class="fl">0</span>, max.controls <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'optmatch'</span></span>
<span><span class="fu">stratumStructure</span><span class="op">(</span><span class="va">stratum</span>, <span class="va">trtgrp</span>, min.controls <span class="op">=</span> <span class="fl">0</span>, max.controls <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">stratumStructure</span><span class="op">(</span><span class="va">stratum</span>, <span class="va">trtgrp</span>, min.controls <span class="op">=</span> <span class="fl">0</span>, max.controls <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'stratumStructure'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-stratum">stratum<a class="anchor" aria-label="anchor" href="#arg-stratum"></a></dt>
<dd><p>Matched strata, as returned by
<code><a href="fullmatch.html">fullmatch</a></code> or <code><a href="pairmatch.html">pairmatch</a></code></p></dd>


<dt id="arg-trtgrp">trtgrp<a class="anchor" aria-label="anchor" href="#arg-trtgrp"></a></dt>
<dd><p>Dummy variable for treatment group membership.  (Not
required if <code>stratum</code> is an optmatch object, as returned by
<code><a href="fullmatch.html">fullmatch</a></code> or <code><a href="pairmatch.html">pairmatch</a></code>.)</p></dd>


<dt id="arg-min-controls">min.controls<a class="anchor" aria-label="anchor" href="#arg-min-controls"></a></dt>
<dd><p>For display, the number of treatment group
members per stratum will be truncated at the reciprocal of
<code>min.controls</code>.</p></dd>


<dt id="arg-max-controls">max.controls<a class="anchor" aria-label="anchor" href="#arg-max-controls"></a></dt>
<dd><p>For display, the number of control group
members will be truncated at <code>max.controls</code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>stratumStructure object to be printed.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to <code>print</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A table showing frequency of occurrence of those
  treatment:control ratios that occur.</p>
<p>The ‘effective sample size’ of the stratification, in
  matched pairs.  Given as an attribute of the table, named
  ‘<code>comparable.num.matched.pairs</code>’; see Note.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>For comparing treatment and control groups both of size 10,
  say, a stratification consisting of two strata, one with 9
  treatments and 1 control, has a smaller ‘effective sample
  size’, intuitively, than a stratification into 10 matched pairs,
  despite the fact that both contain 20 subjects in
  total. <code>stratumStructure</code> first summarizes this aspect of
  the structure of the stratification it is given, then goes on to
  identify one number as the stratification's effective sample
  size.  The ‘<code>comparable.num.matched.pairs</code>’
  attribute returned by <code>stratumStructure</code> is the sum of
  harmonic means of the sizes of the treatment and control
  subgroups of each stratum, a general way of calibrating such
  differences as well as differences in the number of subjects
  contained in a stratification.  For example, by this metric the
  9:1, 1:9 stratification is comparable to 3.6 matched pairs.</p>
<p>Why should effective sample size be calculated this way?  The
  phrase ‘effective sample size’ suggests the observations
  are taken to be similar in information content.  Modeling them
  as random variables, this suggests that they be assumed to have
  the same variance, \(\sigma\), conditional on what
  stratum they reside in.  If that is the case, and if also
  treatment and control observations differ in expectation by a
  constant that is the same for each stratum, then it can be shown
  that the optimum weights with which to combine treatment-control
  contrasts across strata, \(s\), are proportional to the
  stratum-wise harmonic means of treatment and control counts,
  \(h_s = [(n_{ts}^{-1} + n_{cs}^{-1})/2]^{-1}\) (Kalton, 1968).  The thus-weighted
  average of contrasts then has variance \(2\sigma/\sum_s
  h_s\). This motivates the use of \(\sum_s
  h_s\) as a measure of effective sample size (Hansen, 2011).
  Somewhat different motivations of the same calculation appear
  in Hansen (2004) and in Hansen and Bowers (2008).  Since for a
  matched pair \(s\), \(h_s=1\), \(\sum_s
  h_s\) can be thought of as the number of matched pairs
  needed to attain comparable precision.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kalton, G. (1968), ‘Standardization: A
  technique to control for extraneous variables’, <em>Applied
  Statistics</em>, <b>17</b>, 118–136.</p>
<p>Hansen, B.B. (2004), ‘Full Matching in an Observational
  Study of Coaching for the SAT’, <em>Journal of the American
  Statistical Association</em>, <b>99</b>, 609–618.</p>
<p>Hansen B.B. and Bowers, J. (2008), ‘Covariate balance in
  simple, stratified and clustered comparative studies’,
  <em>Statistical Science</em>, <b>23</b> (2), 219–236.</p>
<p>Hansen, B.B. (2011), ‘Propensity score matching to extract
  latent experiments from nonexperimental data: A case study’.
  Ch. 9 of <em>Looking Backwards: Proceedings from a Conference
  in Honor of Paul W. Holland</em>, Springer.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="matched.html">matched</a></code>, <code><a href="fullmatch.html">fullmatch</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ben B. Hansen</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">plantdist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plantsfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="fullmatch.html">fullmatch</a></span><span class="op">(</span><span class="va">plantdist</span><span class="op">)</span> <span class="co"># A full match with unrestricted</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Without 'data' argument the order of the match is not guaranteed</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>     to be the same as your original data.</span>
<span class="r-in"><span>                                 <span class="co"># treatment-control balance</span></span></span>
<span class="r-in"><span><span class="va">plantsfm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="fullmatch.html">fullmatch</a></span><span class="op">(</span><span class="va">plantdist</span>,min.controls<span class="op">=</span><span class="fl">2</span>, max.controls<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Without 'data' argument the order of the match is not guaranteed</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>     to be the same as your original data.</span>
<span class="r-in"><span><span class="fu">stratumStructure</span><span class="op">(</span><span class="va">plantsfm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:1 1:2 1:3 1:4 1:6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2   2   1   1   1 </span>
<span class="r-in"><span><span class="fu">stratumStructure</span><span class="op">(</span><span class="va">plantsfm1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:2 1:3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2   5 </span>
<span class="r-in"><span><span class="fu">stratumStructure</span><span class="op">(</span><span class="va">plantsfm</span>, max.controls<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:1  1:2  1:3 1:4+ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2    2    1    2 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Hansen, Mark Fredrickson, Josh Errickson, Josh Buckner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

